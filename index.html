<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFFQM Pattern Editor</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="container"></div>

    <div class="ui-wrapper">
        <div id="controls">
            <div class="panel-header">
                <div class="mode-indicator" id="mode">Mode: Design</div>

                <button class="info-button" id="info-btn" aria-label="Show information">
                    <span style="font-size: 20px; font-weight: bold; color: #3b82f6;">?</span>
                </button>
            </div>

            <div id="design-controls">
                <p>Configure the L-shaped boundary</p>
                <div id="vertices-list"></div>
                <button id="generate-miura-btn">Generate Miura-Ori Boundary</button>
                <div id="miura-params" class="param-panel" style="display: none;">
                    <h3>Miura-Ori Parameters</h3>

                    <div class="input-group">
                        <label>Horizontal Vertices (nx):</label>
                        <input type="number" id="x-verts" value="6" min="2">
                    </div>

                    <div class="input-group">
                        <label>Vertical Vertices (ny):</label>
                        <input type="number" id="y-verts" value="6" min="2">
                    </div>

                    <div class="input-group">
                        <label>Angle (θ°):</label>
                        <input type="number" id="theta" value="30" step="1">
                    </div>

                    <div class="input-group">
                        <label>Lx-Length:</label>
                        <input type="number" id="h-length" value="1" step="0.5">
                    </div>

                    <div class="input-group">
                        <label>Ly-Length:</label>
                        <input type="number" id="v-length" value="1" step="0.5">
                    </div>

                    <div class="actions">
                        <button id="apply-miura-btn" class="primary">Generate Boundary</button>
                        <button onclick="document.getElementById('miura-params').style.display='none'">Cancel</button>
                    </div>
                </div>
                <button id="build-btn">Build RFFQM Pattern</button>
                <label>Pattern Building Speed</label>
                <input type="range" id="speedSlider" min="1" max="100" value="70">
                <button id="fold-btn" style="display: none; background-color: #ff9800;">Fold Pattern</button>
            </div>

            <div id="folding-controls" style="display: none;">
                <p>Folding Mode</p>
                <div class="slider-container">
                    <label>Activation Angle: <span id="angle-value">0°</span></label>
                    <input type="range" id="angle-slider" min="0" max="180" value="0" step="1">
                </div>
                <button id="back-to-design-btn">Back to Design</button>
            </div>

            <div id="message"></div>
        </div>

        <div id="info-panel">
            <div class="info-header">
                <div class="panel-header">
                    <h4 style="margin-top: 0; margin-bottom: 0;">RFFQM Origami</h4>
                </div>
                <button class="info-button" id="close-info-btn" aria-label="Close information panel">
                    <span style="font-size: 20px; font-weight: bold; color: #3b82f6;">×</span>
                </button>
            </div>

            <div class="info-content">
                <p><strong>Rigid and Flat-Foldable Quadrilateral Mesh (RFFQM)</strong> origami patterns are
                    generalizations of the periodic Miura-Ori pattern.</p>
                <p>These patterns can be constructed by propagating the input data from the left and bottom
                    boundaries to the rest of the pattern.
                </p>

                <p>
                    Here you can <strong>edit the boundary</strong> and see the <strong>folding process</strong> of
                    the resulting pattern.
                </p>

                <hr class="info-divider">

                <div class="reference-section">
                    <!-- <div class="reference-title"></div> -->
                    <!-- <p> -->
                    <ul class="ref-list">
                        <li>
                            <span>Simulator is based on the algorithm from:</span>
                            <a href="https://doi.org/10.1016/j.jmps.2020.104018" target="_blank"
                                rel="noopener noreferrer" class="reference-link">The designs and deformations of
                                rigidly and flat-foldable quadrilateral mesh
                                origami</a>
                        </li>
                        <!-- </p> -->

                        <!-- <div class="reference-title" style="margin-top:12px;"></div> -->
                        <!-- <p> -->
                        <li>
                            <span>Also check out our work:</span>
                            <a href="https://doi.org/10.1016/j.jmps.2024.106003" target="_blank"
                                rel="noopener noreferrer" class="reference-link">A continuum geometric approach for
                                inverse design of origami structures</a><span>,
                                where we used RFFQM patterns to inverse design target surfaces.</span>
                        </li>
                        <!-- </p> -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <script type="module" src="js/Main.js"></script>
</body>

</html>